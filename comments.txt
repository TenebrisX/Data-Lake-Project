Привет!
Спасибо за комментарии и замечания!

Внес исправления:

1) 
"До этого момента все отлично)
Здесь кажется, если группировать по пользователю и городу, то получается сумма дней посещения. Если пользователь был в городе А 20 дней, потому куда-то уехал и вернулся в город А еще на 8 дней, то сумма даст для этого города 28 дней. Но непрерывно он был в городе только 20 и 8 дней
Кажется, можно сделать фильтр по days_in_city и найти последний подходящий город"


- добавил фильтрацию к result:
    .filter('total_days >= {}'.format(min_duration_days))
    .filter('days_in_city >= {}'.format(min_duration_days))
Но если пользователь находился в "домашнем" городе несколько раз с перерывами, возможно данные будут не точными...

2)
"Подскажи, а где повторно используется датасет?"

.persist()  # Consider persisting if this DataFrame is reused 
- Забыл удалить. Теперь удаленно)

3)
"Немного неожиданно, что здесь к датасету добавляются месяц и неделя, все-таки метод вычисляет ближайшую зону"

- Согласен, это было сделанно чтобы в мейне не писать лишний код, но оно нарушает принцип single responsobility.  
Перенес в AnalyticsEngine-calculate_mart_zones, тоже не идеально, но логичней чем в GeoProcessor на мой взгляд.



